function ANM(a,b,c,d,e,f,g,h){"use strict";var i=this;i.identifier=a,i.name=b,i.location=c,i.ecCount=d,i.fpCount=e,i.ancCount=f,i.pncCount=g,i.childCount=h}angular.module("drishtiSiteApp.filters",[]),angular.module("drishtiSiteApp",["ngCookies","ngRoute","angular-momentjs","ui.bootstrap","drishtiSiteApp.filters"]).constant("AUTH_URL","https://smartregistries.org/authenticate-user").constant("REPORT_DATASET","0f07189134224f089a1a53e0aa5fb19c").constant("DRISHTI_REPORT_BASE_URL","https://smartregistries.org/drishti-reporting").constant("DRISHTI_WEB_BASE_URL","https://smartregistries.org").constant("JSON_TO_XLS_BASE_URL","http://xls.ona.io").constant("NRHM_REPORT_TOKEN","e0739ade6dbb47a49c9115a93b3f433a").constant("REGISTER_TOKENS",{ec:"e86e0e2211f54b128181cdec0b63cb11",anc:"dd3ac9bd3d7f469fbc7d0c7d73a442e6",fp:"e0739ade6dbb47a49c9115a93b3f433b"}).constant("ARCHIVED_REPORTS_START_YEAR",2013).config(["$routeProvider","$momentProvider",function(a,b){"use strict";b.asyncLoading(!1).scriptUrl("bower_components/moment/moment.js"),a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/indicators-month/:indicator",{templateUrl:"views/indicators-month.html",controller:"IndicatorMonthCtrl"}).when("/indicators-cumulative/:indicator",{templateUrl:"views/indicators-cumulative.html",controller:"IndicatorCumulativeCtrl"}).when("/registers",{templateUrl:"views/registers.html",controller:"PrintRegisterCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/logout",{templateUrl:"views/login.html",controller:"LogoutCtrl"}).when("/404",{templateUrl:"views/404.html",controller:"MainCtrl"}).otherwise({redirectTo:"404"})}]).run(["$rootScope","$location","$window","Authentication","$http",function(a,b,c,d,e){"use strict";a.$on("$locationChangeStart",function(){d.isAuthenticated()||(b.path("/login"),a.$$phase?c.location="#/login":a.$apply(),delete e.defaults.headers.common["X-Requested-With"],delete e.defaults.headers.common.Authorization)})}]),_.mixin(_.str.exports()),angular.module("drishtiSiteApp.filters").filter("humanizeAndTitleize",function(){"use strict";return function(a){try{return _.str.titleize(_.str.humanize(a))}catch(b){return""}}}),angular.module("drishtiSiteApp.filters").filter("fpMethodsFriendlyName",function(){"use strict";return function(a){var b={ocp:"OCP",iud:"IUD",condom:"Condom",female_sterilization:"Female Sterilization",male_sterilization:"Male Sterilization",none:"None",traditional_methods:"Traditional Methods",dmpa_injectable:"DMPA Injectable",lam:"LAM"};return b[a]||a}}),angular.module("drishtiSiteApp.filters").filter("castesFriendlyName",function(){"use strict";return function(a){var b={sc:"SC",st:"ST",c_others:"Others"};return b[a]||a}}),angular.module("drishtiSiteApp.filters").filter("humanizeChildAge",["$moment",function(a){"use strict";return function(b){var c=[b[0],b[1]-1,b[2]],d=a(),e=d.diff(a(c),"days");if(28>=e)return e+" d.";var f=d.diff(a(c),"weeks");if(14>=f)return f+" w.";var g=d.diff(a(c),"months");if(24>g)return g+" m.";var h=d.diff(a(c),"years"),i=g-12*h;return 0!==i?h+" y. "+i+" m.":h+" y."}}]),angular.module("drishtiSiteApp.filters").filter("humanizeWifeAge",["$moment",function(a){"use strict";return function(b){return a().diff(a(b),"years")}}]),DownloadStatus={Preparing:"preparing",Ready:"ready"},angular.module("drishtiSiteApp").value("ReportsDefinitions",{fp:{name:"Family Planning Services",services:["IUD","CONDOM","OCP","MALE_STERILIZATION","FEMALE_STERILIZATION"]},anc:{name:"ANC Services",services:["EARLY_ANC_REGISTRATIONS","ANC_REGISTRATIONS","SUB_TT","TT1","TT2","TTB","ANC4"]},"pregnancy-outcomes":{name:"Pregnancy Outcomes",services:["LIVE_BIRTH","STILL_BIRTH","EARLY_ABORTIONS","LATE_ABORTIONS","SPONTANEOUS_ABORTION","DELIVERY","INSTITUTIONAL_DELIVERY","D_HOM","D_SC","D_PHC","D_CHC","D_SDH","D_DH","D_PRI"]},pnc:{name:"PNC Services",services:["PNC3"]},mortality:{name:"Mortality",services:["ENM","NM","LNM","INFANT_MORTALITY","CHILD_MORTALITY","MMA","MMD","MMP","MM"]},"child-services":{name:"Child Services",services:["DPT3_OR_OPV3","DPT_BOOSTER_OR_OPV_BOOSTER","DPT_BOOSTER2","HEP","OPV","MEASLES","BCG","LBW","BF_POST_BIRTH","WEIGHED_AT_BIRTH","VIT_A_1","VIT_A_2"]}}).service("Authentication",["$rootScope","$cookieStore","BasicAuth","Base64",function(a,b,c,d){"use strict";return{authenticate:function(a,b){c.setCredentials(a,b)},clearCredentials:function(){c.clearCredentials()},isAuthenticated:function(){var c=b.get("authdata");return c?(a.username=d.decode(c).split(":")[0],!0):!1}}}]).service("BasicAuth",["Base64","$cookieStore","$http",function(a,b,c){"use strict";return c.defaults.headers.common.Authorization="Basic "+b.get("authdata"),{setCredentials:function(d,e){var f=a.encode(d+":"+e);c.defaults.headers.common.Authorization="Basic "+f,b.put("authdata",f)},clearCredentials:function(){document.execCommand("ClearAuthenticationCache"),b.remove("authdata"),c.defaults.headers.common.Authorization="Basic "}}}]).service("Base64",function(){"use strict";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(b){var c,d,e,f,g,h="",i="",j="",k=0;do c=b.charCodeAt(k++),d=b.charCodeAt(k++),i=b.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+a.charAt(e)+a.charAt(f)+a.charAt(g)+a.charAt(j),c=d=i="",e=f=g=j="";while(k<b.length);return h},decode:function(b){var c,d,e,f,g,h="",i="",j="",k=0,l=/[^A-Za-z0-9\+\/\=]/g;l.exec(b)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=a.indexOf(b.charAt(k++)),f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),j=a.indexOf(b.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!==g&&(h+=String.fromCharCode(d)),64!==j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<b.length);return h}}}).service("BambooAPI",["$q","$rootScope",function(a,b){"use strict";var c=function(a){b.$$phase?a():b.$apply(a)};return{queryInfo:function(b){var d=a.defer(),e=new bamboo.Dataset({id:b});return e.query_info(function(a){c(function(){d.resolve(a)})}),d.promise},querySummary:function(b,d,e){var f=a.defer(),g=new bamboo.Dataset({id:b});return g.summary(d,e,function(a){c(function(){f.resolve(a)})}),f.promise},queryCalculations:function(b){var d=a.defer(),e=new bamboo.Dataset({id:b});return e.query_calculations(function(a){c(function(){d.resolve(a)})}),d.promise},addCalculation:function(b,d,e){var f=a.defer(),g=new bamboo.Dataset({id:b});return g.add_calculation(d,e,function(a){c(function(){f.resolve(a)})}),f.promise},removeCalculation:function(a,b){var c=new bamboo.Dataset({id:a});c.remove_calculation(b)}}}]),angular.module("drishtiSiteApp").service("JSONXLSService",["$http","$q","$moment","JSON_TO_XLS_BASE_URL",function(a,b,c,d){"use strict";var e=function(c,e){var f=a.defaults.headers.common["X-Requested-With"],g=a.defaults.headers.common.Authorization;return delete a.defaults.headers.common["X-Requested-With"],delete a.defaults.headers.common.Authorization,a({method:"POST",url:d+"/xls/"+c,data:e}).then(function(a){return d+a.data},function(){return console.log("Error when getting register from json-to-xls service."),b.reject("Error when getting register from json-to-xls service.")}).finally(function(){a.defaults.headers.common["X-Requested-With"]=f,a.defaults.headers.common.Authorization=g})};return{prepareRegister:function(a,b){return e(a,b)}}}]),angular.module("drishtiSiteApp").service("ECRegisterService",["$http","$q","$moment","$filter","DRISHTI_WEB_BASE_URL","JSON_TO_XLS_BASE_URL","JSONXLSService","REGISTER_TOKENS",function(a,b,c,d,e,f,g,h){"use strict";var i=function(c){var f=e+"/registers/ec?anm-id="+c.identifier;return a({method:"GET",url:f}).then(function(a){return a.data},function(){return console.log("Error when getting EC register for anm:"+c.identifier),b.reject("Error when getting EC register for anm:"+c.identifier)}).then(function(a){return j(a),k(a,c),a.ecRegisterEntries.forEach(function(a){a.village=d("humanizeAndTitleize")(a.village),a.householdDetails=a.householdNumber+(a.householdAddress?", "+a.householdAddress:"")+(a.headOfHousehold?", "+a.headOfHousehold:""),a.economicStatus=(a.economicStatus||"").toUpperCase(),a.educationLevel=(a.wifeEducationLevel?a.wifeEducationLevel:"")+(a.husbandEducationLevel?" / "+a.husbandEducationLevel:""),a.ageDetails=a.wifeAge+(a.husbandAge?" / "+a.husbandAge:""),a.caste=d("castesFriendlyName")(a.caste),a.currentFPMethod=d("fpMethodsFriendlyName")(a.currentFPMethod),a.isPregnant=d("humanizeAndTitleize")(a.isPregnant)}),g.prepareRegister(h.ec,a)})},j=function(a){a.generatedDate=c().format("YYYY-MM-DD")},k=function(a,b){a.anmDetails={location:b.location,name:b.name}};return{prepareRegister:function(a){return i(a)}}}]),angular.module("drishtiSiteApp").service("ANCRegisterService",["$http","$q","$moment","$filter","DRISHTI_WEB_BASE_URL","JSON_TO_XLS_BASE_URL","JSONXLSService","REGISTER_TOKENS",function(a,b,c,d,e,f,g,h){"use strict";var i=function(f){var i=e+"/registers/anc?anm-id="+f.identifier;return a({method:"GET",url:i}).then(function(a){return a.data},function(a){return console.log("Error when getting ANC register for anm:"+f.identifier+", error: "+a),b.reject("Error when getting ANC register for anm:"+f.identifier+", error: "+a)}).then(function(a){return o(a),n(a,f),a.ancRegisterEntries.forEach(function(a){j(a),a.wifeAge=d("humanizeWifeAge")(a.wifeDOB),a.addressDetails=a.wifeName+(a.husbandName?", W/O "+a.husbandName:"")+(a.address?", C/O "+a.address:""),a.casteReligionDetails=a.caste?d("castesFriendlyName")(a.caste):"",a.casteReligionDetails=(""===a.casteReligionDetails?"":a.casteReligionDetails)+(a.religion?"/"+a.religion:""),a.economicStatus=(a.economicStatus?a.economicStatus.toUpperCase():"")+(a.bplCardNumber?"("+a.bplCardNumber+")":""),a.youngestChildDOB&&(a.youngestChildAge=d("humanizeChildAge")(a.youngestChildDOB)),a.lmpEDDDetails=c(a.lmp).format("YYYY-MM-DD")+" "+c(a.edd).format("YYYY-MM-DD"),l(a.ancVisits),m(a.ancVisits)}),g.prepareRegister(h.anc,a)})},j=function(a){var b=["ttDoses","ifaTablets","ancVisits","remarks","contentHolder"],c=[];return b.forEach(function(b){a[b]=a[b]||[],c.push(a[b].length)}),a.maxLength=_.max(c),b.forEach(function(b){k(a,b)}),a},k=function(a,b){a[b]=a[b].concat(_(a.maxLength-a[b].length).times(function(){return{}}))},l=function(a){a.forEach(function(a){a.rtiSTIValue=(a.rti?a.rti:"")+(a.sti?"/"+a.sti:"")})},m=function(a){a.forEach(function(a){a.bp=(a.bpSystolic||"")+(a.bpDiastolic?"/"+a.bpDiastolic:"")})},n=function(a,b){a.anmDetails={location:b.location,name:b.name}},o=function(a){a.generatedDate=c().format("YYYY-MM-DD")};return{prepareRegister:function(a){return i(a)}}}]),angular.module("drishtiSiteApp").service("FPRegisterService",function(){"use strict";var a=function(a){var b={iudUsers:[],condomUsers:[],ocpUsers:[],maleSterilizationUsers:[],femaleSterilizationUsers:[]};return a.forEach(function(a){a.wifeAge=Math.floor((new Date-new Date(Date.parse(a.wifeDOB)))/1e3/60/60/24/365),a.husbandAge=Math.floor((new Date-new Date(Date.parse(a.husbandDOB)))/1e3/60/60/24/365),"iud"===a.fpDetails.method?b.iudUsers.push(a):"condom"===a.fpDetails.method?b.condomUsers.push(a):"ocp"===a.fpDetails.method?b.ocpUsers.push(a):"male_sterilization"===a.fpDetails.method?b.maleSterilizationUsers.push(a):"female_sterilization"===a.fpDetails.method&&b.femaleSterilizationUsers.push(a)}),b};return{fpUsers:function(b){return a(b)}}}),angular.module("drishtiSiteApp").service("RegisterService",["ECRegisterService","FPRegisterService","ANCRegisterService",function(a,b,c){"use strict";var d=function(a){return b.fpUsers(a)},e=function(b){return a.prepareRegister(b)},f=function(a){return c.prepareRegister(a)};return{fpUsers:function(a){return d(a)},prepareRegisterForEC:function(a){return e(a)},prepareRegisterForANC:function(a){return f(a)}}}]),angular.module("drishtiSiteApp").service("LoginService",["$q","$http","Authentication","Base64","DRISHTI_WEB_BASE_URL",function(a,b,c,d,e){"use strict";var f=function(a,f){var g=e+"/authenticate-user",h="Basic "+d.encode(a+":"+f);return c.clearCredentials(),b({method:"GET",url:g,headers:{Authorization:h}}).then(function(){return!0},function(){return delete b.defaults.headers.common.Authorization,!1})};return{login:function(a,b){return f(a,b)}}}]),angular.module("drishtiSiteApp").service("ANMService",["$http","$q","DRISHTI_REPORT_BASE_URL","DRISHTI_WEB_BASE_URL","JSON_TO_XLS_BASE_URL","NRHM_REPORT_TOKEN",function(a,b,c,d,e,f){"use strict";var g=function(){var c=d+"/anms";return a({method:"GET",url:c}).success(function(a){return _.map(a.anmDetails,function(a){return new ANM(a.identifier,a.name,a.location,a.ecCount,a.fpCount,a.ancCount,a.pncCount,a.childCount)})}).error(function(){return console.log("Error when getting ANMs micro service."),b.reject("Error when getting ANMs micro service.")})},h=function(d,g,h){var i=c+"/report/aggregated-reports?anm-id="+d+"&month="+g+"&year="+h;return a({method:"GET",url:i}).then(function(a){return a.data},function(){return console.log("Error when getting aggregated reports."),b.reject("Error when getting aggregated reports.")}).then(function(c){return a({method:"POST",url:e+"/xls/"+f,data:c}).then(function(a){return e+a.data},function(){return console.log("Error when getting excel from json-to-xls service."),b.reject("Error when getting excel from json-to-xls service.")})})};return{all:function(){return g()},prepareReportFor:function(a,b,c){return h(a,b,c)}}}]),angular.module("drishtiSiteApp").controller("LoginCtrl",["$scope","$location","$http","$window","Authentication","LoginService",function(a,b,c,d,e,f){"use strict";a.loginUser=function(){f.login(a.username,a.password).then(function(b){b===!0?(e.authenticate(a.username,a.password),d.location="#/",a.$$phase||a.$apply()):(alert("Authentication failed for user: "+a.username),d.location="#/")},function(){alert("Authentication failed for user: "+a.username),d.location="#/"})}}]).controller("LogoutCtrl",["$scope","$location","$http","$window","Authentication",function(a,b,c,d,e){"use strict";e.clearCredentials(),b.path("#/"),a.$$phase?d.location="#/":a.$apply()}]).controller("MainCtrl",function(){}).controller("IndicatorMonthCtrl",["$scope","$routeParams","ReportsDefinitions","BambooAPI","REPORT_DATASET",function(a,b,c,d,e){"use strict";a.indicator=b.indicator;var f=c[a.indicator],g=d.querySummary(e,{indicator:1},"service_provider");a.servicesProvided=f.services,g.then(function(b){a.serviceProviders=Object.keys(b.service_provider),a.data=b.service_provider,a.data.totals={serviceProviders:{},servicesProvided:{},all:0},a.serviceProviders.forEach(function(c){var d=0,e=b.service_provider[c].indicator.summary;a.servicesProvided.forEach(function(a){d+=e[a]||0}),a.data.totals.serviceProviders[c]=d});var c=0;a.servicesProvided.forEach(function(d){var e=0;a.serviceProviders.forEach(function(a){e+=b.service_provider[a].indicator.summary[d]||0}),a.data.totals.servicesProvided[d]=e,c+=e}),a.data.totals.all=c})}]).controller("IndicatorCumulativeCtrl",["$scope","$routeParams",function(a,b){"use strict";a.indicator=b.indicator}]),angular.module("drishtiSiteApp").controller("PrintRegisterCtrl",["$scope","FPPrintRegisterService",function(a,b){"use strict";var c=[{registrationDate:"2013-01-01",ecNumber:"1",wifeName:"Maanu",husbandName:"Putta",village:"Bherya",wifeDOB:"1987-09-17",husbandDOB:"1985-12-20",caste:"c_others",religion:"hindu",wifeEducationLevel:"graduate",husbandEducationLevel:"graduate",lmp:"2012-12-15",upt:"-ve",maleChildren:"0",femaleChildren:"0",fpDetails:{method:"condom",details:{refillDates:["2012-04-03","2012-05-05","","2012-07-07","2012-08-15","","","2012-11-20","","","",""],remarks:"Need to supply Condom to this couple"}}},{registrationDate:"2013-02-01",ecNumber:"12",wifeName:"Pavani",husbandName:"Pavan",village:"T Narasipura",wifeDOB:"1990-01-14",husbandDOB:"1986-08-13",caste:"c_others",religion:"hindu",wifeEducationLevel:"graduate",husbandEducationLevel:"graduate",lmp:"2013-01-27",upt:"-ve",maleChildren:"0",femaleChildren:"0",fpDetails:{method:"condom",details:{refillDates:["2012-04-19","2012-05-04","2012-06-05","2012-07-06","","2012-09-20","","2012-10-10","","","2013-02-01","2013-03-17"],remarks:"Have to meet them during village visit next week"}}},{registrationDate:"2013-02-26",ecNumber:"12",wifeName:"Ahalya",husbandName:"Pandu",village:"Bannur",wifeDOB:"1988-03-11",husbandDOB:"1985-07-11",caste:"sc",religion:"hindu",wifeEducationLevel:"illeterate",husbandEducationLevel:"puc",lmp:"2013-02-10",upt:"-ve",maleChildren:"1",femaleChildren:"0",fpDetails:{method:"condom",details:{refillDates:["2012-04-01","2012-05-06","2012-06-02","2012-07-15","2012-08-11","","2012-10-22","2012-11-01","2012-12-20","","2013-2-01","2013-02-17"]}}},{registrationDate:"2013-03-02",ecNumber:"2",wifeName:"Rani",husbandName:"Raja",village:"Keelanapura",wifeDOB:"1984-08-01",husbandDOB:"1983-01-01",caste:"sc",religion:"hindu",wifeEducationLevel:"illiterate",husbandEducationLevel:"illiterate",lmp:"",upt:"-ve",maleChildren:"0",femaleChildren:"1",fpDetails:{method:"iud",details:{iudDateOfInsertion:"2013-04-01",iudPlaceOfInsertion:"phc",iudInserterName:"bhagya",remarks:"Have to meet them during village visit next week"}}},{registrationDate:"2013-04-01",ecNumber:"245",wifeName:"baby",husbandName:"Anthony",village:"bherya",wifeDOB:"1982-06-01",husbandDOB:"1978-08-01",caste:"c_others",religion:"christian",wifeEducationLevel:"graduate",husbandEducationLevel:"post graduate",lmp:"2013-02-01",upt:"-ve",maleChildren:"1",femaleChildren:"1",fpDetails:{method:"iud",details:{iudDateOfInsertion:"2012-03-01",iudPlaceOfInsertion:"subcenter",iudInserterName:"Dr Rangachari",remarks:"Follow up in 2 months"}}},{registrationDate:"2013-04-10",ecNumber:"25",wifeName:"Fathima",husbandName:"Abdullaha",village:"bherya",wifeDOB:"1985-02-23",husbandDOB:"1977-12-28",caste:"",religion:"muslim",wifeEducationLevel:"illeterate",husbandEducationLevel:"sslc",lmp:"2013-03-18",upt:"-ve",maleChildren:"0",femaleChildren:"1",fpDetails:{method:"iud",details:{iudDateOfInsertion:"2013-02-23",iudPlaceOfInsertion:"district hospital",iudInserterName:"LHV Latha",remarks:"Follow up in 1 months"}}},{registrationDate:"2013-02-01",ecNumber:"34",wifeName:"Gayathri",husbandName:"Raju",village:"Gauribidanur",wifeDOB:"1980-01-03",husbandDOB:"1975-04-02",caste:"sc",religion:"hindu",wifeEducationLevel:"illiterate",husbandEducationLevel:"illiterate",lmp:"",upt:"-ve",maleChildren:"1",femaleChildren:"1",fpDetails:{method:"ocp",details:{refillDates:["2012-04-23","2012-05-26","2012-06-15","2012-07-10","2012-08-22","2012-09-19","2012-10-24","2012-11-05","2012-12-24","2013-01-24","2013-02-26","2013-03-17"]}}},{registrationDate:"2013-01-04",ecNumber:"233",wifeName:"Shashi",husbandName:"Anand",village:"Arishinadalli",wifeDOB:"1990-01-03",husbandDOB:"1980-04-02",caste:"brahmin",religion:"hindu",wifeEducationLevel:"graduate",husbandEducationLevel:"graduate",lmp:"2013-07-24",upt:"-ve",maleChildren:"1",femaleChildren:"0",fpDetails:{method:"ocp",details:{refillDates:["2012-04-22","2012-05-12","2012-06-14","2012-07-04","2012-08-06","2012-09-14","2012-10-04","2012-11-15","2012-12-31","2012-01-20","2012-02-16","2012-03-27"]}}},{registrationDate:"2013-02-04",ecNumber:"15",wifeName:"Rama",husbandName:"Alok",village:"Bychapura",wifeDOB:"1983-01-03",husbandDOB:"1980-04-02",caste:"st",religion:"hindu",wifeEducationLevel:"graduate",husbandEducationLevel:"illiterate",lmp:"2013-06-22",upt:"+ve",maleChildren:"1",femaleChildren:"0",fpDetails:{method:"ocp",details:{refillDates:["2012-04-22","2012-05-12","","","","","","","","","",""]}}},{registrationDate:"2013-04-02",ecNumber:"54",wifeName:"Fiza",husbandName:"Farooq",village:"Dammatmari",wifeDOB:"1982-01-01",husbandDOB:"1981-01-02",caste:"",religion:"muslim",wifeEducationLevel:"graduate",husbandEducationLevel:"graduate",lmp:"",upt:"",maleChildren:"1",femaleChildren:"1",fpDetails:{method:"male_sterilization",details:{doctorName:"krishna murthy",typeOfSterilization:"nsv",sterilizationDate:"2013-05-01",followupVisitDates:["2013-05-06","2013-05-10","2013-06-10"],remarks:""}}},{registrationDate:"2013-05-12",ecNumber:"543",wifeName:"Rangamma",husbandName:"Chandru",village:"Bychapura",wifeDOB:"1986-03-01",husbandDOB:"1984-03-04",caste:"",religion:"jain",wifeEducationLevel:"",husbandEducationLevel:"",lmp:"",upt:"",maleChildren:"1",femaleChildren:"0",fpDetails:{method:"female_sterilization",details:{doctorName:"bhyrappa",typeOfSterilization:"",sterilizationDate:"2013-06-02",followupVisitDates:["2013-06-06","2013-06-10","2013-07-10"],remarks:""}}}];a.date=new Date,a.fpUsers=b.fpUsers(c)}]),angular.module("drishtiSiteApp").controller("ANMDataSummaryCtrl",["$scope","ANMService","RegisterService",function(a,b,c){"use strict";var d=25,e=0,f=11;b.all().then(function(b){a.anms=b.data.anmDetails}),a.excelReportsForANM=function(a,c,d){a.nrhmReportDownloadStatus=DownloadStatus.Preparing,b.prepareReportFor(a.identifier,c,d).then(function(b){a.nrhmReportDownloadStatus=DownloadStatus.Ready,a.excelReport=b},function(){delete a.nrhmReportDownloadStatus})},a.getRegister=function(a,b){var d=b.toLowerCase()+"RegisterDownloadStatus";a[d]=DownloadStatus.Preparing,c["prepareRegisterFor"+b](a).then(function(c){a[b.toLowerCase()+"RegisterDownloadStatus"]=DownloadStatus.Ready,a[b.toLowerCase()+"Register"]=c},function(){delete a[b.toLowerCase()+"RegisterDownloadStatus"]})},a.goBackToReadyState=function(a,b){delete a[b]},a.currentReportMonth=function(){return g().getMonth()+1},a.currentReportYear=function(){return g().getUTCFullYear()};var g=function(){var a=new Date;return a.getDate()>d?a.getMonth()===f?new Date(h(a),e,d):new Date(a.getUTCFullYear(),i(a),d):new Date(a.getUTCFullYear(),a.getMonth(),d)},h=function(a){return a.getUTCFullYear()+1},i=function(a){return a.getMonth()+1}}]),angular.module("drishtiSiteApp").controller("ArchivesCtrl",["$scope","$modal",function(a,b){"use strict";a.open=function(){b.open({templateUrl:"archived-report-modal.html",controller:"ArchivedReportsModalCtrl",resolve:{anm:function(){return a.anm}}})}}]),angular.module("drishtiSiteApp").controller("ArchivedReportsModalCtrl",["$scope","$modalInstance","anm","ARCHIVED_REPORTS_START_YEAR","ANMService",function(a,b,c,d,e){"use strict";var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];a.years=_.range(d,(new Date).getFullYear()+1),a.months=function(){var b=new Date;return a.selectedYear.year!==b.getFullYear()?f:_.filter(f,function(a){return f.indexOf(a)<=b.getMonth()})},a.selectedYear={},a.selectedMonth={},a.downloadReport=function(){a.nrhmReportDownloadStatus=DownloadStatus.Preparing,e.prepareReportFor(c.identifier,f.indexOf(a.selectedMonth.month)+1,a.selectedYear.year).then(function(b){a.nrhmReportDownloadStatus=DownloadStatus.Ready,a.downloadURL=b},function(){})},a.close=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]);